<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avatar Section Visibility Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        .avatar-section {
            background-color: #f0f0f0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 2px solid #ccc;
        }
        .tryon-result {
            background-color: #e8f4f8;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 2px solid #4CAF50;
            display: none;
            position: relative;
        }
        .tryon-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 18px;
            line-height: 1;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            background-color: #dff0d8;
            border: 1px solid #d6e9c6;
        }
    </style>
</head>
<body>
    <h1>Avatar Section Visibility Control Test</h1>
    
    <div class="status">
        <strong>Test Status:</strong> <span id="test-status">Ready to test</span>
    </div>

    <div class="avatar-section">
        <h3>ðŸ“¸ Avatar Section</h3>
        <p>This section should be hidden when try-on results are shown and visible when results are closed.</p>
        <div style="background: #ddd; padding: 20px; text-align: center;">
            Avatar Upload Area Placeholder
        </div>
    </div>

    <div id="tryon-result" class="tryon-result">
        <!-- Try-on results will be displayed here -->
    </div>

    <div>
        <h3>Test Controls:</h3>
        <button onclick="showTryOnResult()">Show Try-On Result (Hide Avatar)</button>
        <button onclick="hideTryOnResult()">Hide Try-On Result (Show Avatar)</button>
        <button onclick="simulateRefresh()">Simulate Refresh Button</button>
        <button onclick="resetTest()">Reset Test</button>
    </div>

    <div>
        <h3>Expected Behavior:</h3>
        <ul>
            <li>Avatar section should be <strong>visible</strong> by default</li>
            <li>When try-on result is shown, avatar section should be <strong>hidden</strong></li>
            <li>When try-on result is closed (X button), avatar section should be <strong>visible</strong> again</li>
            <li>When refresh is clicked, avatar section should be <strong>visible</strong></li>
        </ul>
    </div>

    <script>
        // Avatar section visibility helper functions (copied from popup.js)
        function hideAvatarSection() {
            const avatarSection = document.querySelector('.avatar-section');
            if (avatarSection) {
                avatarSection.style.display = 'none';
                updateStatus('Avatar section hidden');
            }
        }

        function showAvatarSection() {
            const avatarSection = document.querySelector('.avatar-section');
            if (avatarSection) {
                avatarSection.style.display = 'block';
                updateStatus('Avatar section shown');
            }
        }

        // Helper function to create close button with avatar section showing
        function createCloseButtonHTML() {
            return '<button class="tryon-close-btn" onclick="document.getElementById(\'tryon-result\').style.display=\'none\'; document.querySelector(\'.avatar-section\').style.display=\'block\'; updateStatus(\'Try-on result closed, avatar section shown\');">&times;</button>';
        }

        function updateStatus(message) {
            document.getElementById('test-status').textContent = message;
        }

        // Test functions
        function showTryOnResult() {
            const tryonResult = document.getElementById('tryon-result');
            tryonResult.innerHTML = createCloseButtonHTML() + '<h3>âœ… Try-On Result</h3><p>This is a simulated try-on result. Click the X button to close.</p><div style="background: #4CAF50; color: white; padding: 20px; text-align: center; margin-top: 10px;">Simulated Try-On Image</div>';
            tryonResult.style.display = 'block';
            hideAvatarSection();
        }

        function hideTryOnResult() {
            const tryonResult = document.getElementById('tryon-result');
            tryonResult.style.display = 'none';
            tryonResult.innerHTML = '';
            showAvatarSection();
        }

        function simulateRefresh() {
            hideTryOnResult();
            updateStatus('Refresh completed - avatar section visible');
        }

        function resetTest() {
            hideTryOnResult();
            updateStatus('Test reset - ready to test');
        }

        // Initialize
        updateStatus('Test loaded - avatar section should be visible');
    </script>
</body>
</html>